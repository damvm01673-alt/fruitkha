@model IEnumerable<FruitkhaWeb.Models.Product>

@{
    ViewData["Title"] = ViewBag.CategoryName != null ? ViewBag.CategoryName : "Danh sách sản phẩm";
}

<!-- breadcrumb -->
<div class="breadcrumb-section breadcrumb-bg">
	<div class="container">
		<div class="row">
			<div class="col-lg-8 offset-lg-2 text-center">
				<div class="breadcrumb-text">
					<p>Tươi và Hữu cơ</p>
					<h1>@ViewData["Title"]</h1>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- end breadcrumb -->

<!-- products -->
<div class="product-section mt-150 mb-150">
	<div class="container">
		@if (ViewBag.Keyword != null)
		{
			<div class="row">
				<div class="col-lg-12">
					<div class="alert alert-info">
						Kết quả tìm kiếm cho: <strong>@ViewBag.Keyword</strong>
					</div>
				</div>
			</div>
		}

		<div class="row">
			@if (Model.Any())
			{
				foreach (var product in Model)
				{
					<div class="col-lg-4 col-md-6 text-center mb-4">
						<div class="single-product-item">
							<div class="product-image">
								<a asp-controller="Products" asp-action="Details" asp-route-id="@product.Id">
									<img src="~/@(product.ImageUrl ?? "assets/img/products/product-img-1.jpg")" alt="@product.Name">
								</a>
								@if (product.IsPromotional && product.SalePrice.HasValue)
								{
									<span class="badge badge-danger" style="position: absolute; top: 10px; right: 10px;">SALE!</span>
								}
								@if (product.IsNewProduct)
								{
									<span class="badge badge-success" style="position: absolute; top: 10px; left: 10px;">MỚI</span>
								}
							</div>
							<h3>@product.Name</h3>
							<p class="product-price">
								@if (product.SalePrice.HasValue)
								{
									<span style="text-decoration: line-through; color: #999;">@product.Price.ToString("N0")đ</span>
									<span class="orange-text">@product.SalePrice.Value.ToString("N0")đ</span>
								}
								else
								{
									<span>@product.Price.ToString("N0")đ</span>
								}
							</p>
							<a asp-controller="Cart" asp-action="AddToCart" asp-route-id="@product.Id" class="cart-btn"><i class="fas fa-shopping-cart"></i> Thêm vào giỏ</a>
						</div>
					</div>
				}
			}
			else
			{
				<div class="col-lg-12 text-center">
					<p>Không tìm thấy sản phẩm nào.</p>
				</div>
			}
		</div>

		<!-- Pagination -->
		@if (ViewBag.TotalPages > 1)
		{
			<div class="row">
				<div class="col-lg-12 text-center">
					<div class="pagination-wrap">
						<ul>
							@if (ViewBag.CurrentPage > 1)
							{
								<li><a asp-action="Index" asp-route-page="@(ViewBag.CurrentPage - 1)" asp-route-id="@ViewBag.CategoryId">Trước</a></li>
							}

							@for (int i = 1; i <= ViewBag.TotalPages; i++)
							{
								<li><a asp-action="Index" asp-route-page="@i" asp-route-id="@ViewBag.CategoryId" class="@(i == ViewBag.CurrentPage ? "active" : "")">@i</a></li>
							}

							@if (ViewBag.CurrentPage < ViewBag.TotalPages)
							{
								<li><a asp-action="Index" asp-route-page="@(ViewBag.CurrentPage + 1)" asp-route-id="@ViewBag.CategoryId">Sau</a></li>
							}
						</ul>
					</div>
				</div>
			</div>
		}
	</div>
</div>
<!-- end products -->
